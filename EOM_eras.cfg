#textdomain wesnoth-Era_of_Myths

# wmllint: local spelling RPG

#define EOM_SIDE ERA FACTION
    {~add-ons/Era_of_Myths/factions/{FACTION}-{ERA}.cfg}
#enddef

#This is a modification of the mainline 1.12 QUICK_4MP_LEADERS macro, which gives to
#elementals the trait emerald instead of quick

#undef QUICK_4MP_LEADERS
#define QUICK_4MP_LEADERS
    # This makes all leaders with 4 MP receive the quick trait, except ones with
    # unit.variables.dont_make_me_quick=yes (boolean)

    [event]
        name=prestart

        [store_unit]
            [filter]
                canrecruit=yes

                [filter_wml]
                    max_moves=4
                [/filter_wml]
            [/filter]

            kill=yes
            variable=leaders_to_make_quick
        [/store_unit]

        {FOREACH leaders_to_make_quick i}
            [if]
                # The variable check is done here instead of in the [store_unit]
                # so that all boolean values work
                [variable]
                    name=leaders_to_make_quick[$i].variables.dont_make_me_quick
                    boolean_equals=yes
                [/variable]

                [then]
                    [unstore_unit]
                        variable=leaders_to_make_quick[$i]
                    [/unstore_unit]
                [/then]

                [else]
                    [if]
                        [variable]
                            name=leaders_to_make_quick[$i].race
                            equals=elemental
                        [/variable]
                        [then]
                            [set_variables]
                                name=temp
                                [literal]
                                    {TRAIT_EMERALD}
                                [/literal]
                            [/set_variables]
                        [/then]
                        [else]
                            [set_variables]
                                name=temp
                                [literal]
                                    {TRAIT_QUICK}
                                [/literal]
                            [/set_variables]
                        [/else]
                    [/if]

                    [set_variables]
                        name=leaders_to_make_quick[$i].modifications.trait
                        mode=append

                        [insert_tag]
                            name=literal
                            variable=temp.trait
                        [/insert_tag]
                    [/set_variables]

                    {CLEAR_VARIABLE leaders_to_make_quick[$i].max_moves,leaders_to_make_quick[$i].moves,leaders_to_make_quick[$i].max_hitpoints,leaders_to_make_quick[$i].hitpoints}

                    [unstore_unit]
                        variable=leaders_to_make_quick[$i]
                    [/unstore_unit]
                [/else]
            [/if]
        {NEXT i}

        {CLEAR_VARIABLE leaders_to_make_quick,temp}
    [/event]
#enddef

[era]
    id=era_EOM_{ERA_OF_MYTHS_VERSION}
    name= _ "Era of Myths" #Era of Myths
    require_era=yes
    description= _ "The standard Era of Myths.
Pickable factions are:

Celestials
Devlings
Vampires
Therians (Shifters)
Elementals
The Warg
Windsongs"

    {RANDOM_SIDE}
    {EOM_SIDE EOM celestials}
    {EOM_SIDE EOM devlings}
    {EOM_SIDE EOM elementals}
    {EOM_SIDE EOM therians}
    {EOM_SIDE EOM vampires}
    {EOM_SIDE EOM wargs}
    {EOM_SIDE EOM windsong}

    {QUICK_4MP_LEADERS}
    {TURNS_OVER_ADVANTAGE}
    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

[era]
    id=era_EOM_balanced_{ERA_OF_MYTHS_VERSION}
    name= _ "Era of Myths (balanced)"
    require_era=yes
    description= _ "A selection of factions considered balanced. As there would be:

Celestials
Elementals
Vampires
Windsongs"

    {RANDOM_SIDE}
    {EOM_SIDE EOM celestials}
    {EOM_SIDE EOM elementals}
    {EOM_SIDE EOM vampires}
    {EOM_SIDE EOM windsong}

    {QUICK_4MP_LEADERS}
    {TURNS_OVER_ADVANTAGE}
    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

[era]
    id=era_EOM_power_{ERA_OF_MYTHS_VERSION}
    name= _ "Era of Myths Lvl. 2" #Era of Myths - Heroes
    require_era=yes
    description= _ "Same factions like in the standard Era of Myths, but you can recruit level 2 units."

    {RANDOM_SIDE}
    {EOM_SIDE POWER celestials}
    {EOM_SIDE POWER devlings}
    {EOM_SIDE POWER elementals}
    {EOM_SIDE POWER therians}
    {EOM_SIDE POWER vampires}
    {EOM_SIDE POWER wargs}
    {EOM_SIDE POWER windsong}

    {QUICK_4MP_LEADERS}
    {TURNS_OVER_ADVANTAGE}
    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

[era]
    id=era_default_and_EOM_{ERA_OF_MYTHS_VERSION}
    name= _ "Default + Myths" #Era of Myths + Default # Default + Era of Myths
    require_era=yes
    description= _ "The factions from the standard era and the Era of Myths are available."

    {RANDOM_SIDE}
    {EOM_SIDE EOM celestials}
    {EOM_SIDE EOM devlings}
    {EOM_SIDE EOM elementals}
    {EOM_SIDE EOM therians}
    {EOM_SIDE EOM vampires}
    {EOM_SIDE EOM wargs}
    {EOM_SIDE EOM windsong}
    {multiplayer/factions/loyalists-default.cfg}
    {multiplayer/factions/rebels-default.cfg}
    {multiplayer/factions/northerners-default.cfg}
    {multiplayer/factions/undead-default.cfg}
    {multiplayer/factions/knalgans-default.cfg}
    {multiplayer/factions/drakes-default.cfg}
    {multiplayer/factions/khalifate-default.cfg}

    {QUICK_4MP_LEADERS}
    {TURNS_OVER_ADVANTAGE}
    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

[era]
    id=era_EOM_power_aoh_{ERA_OF_MYTHS_VERSION}
    name= _ "Default + Myths Lvl. 2" #Era of Myths - Heroes
    require_era=yes
    description= _ "The standard era and the Era of Myths. You can recruit level 2 units."

    {RANDOM_SIDE}
    {EOM_SIDE POWER celestials}
    {EOM_SIDE POWER devlings}
    {EOM_SIDE POWER elementals}
    {EOM_SIDE POWER therians}
    {EOM_SIDE POWER vampires}
    {EOM_SIDE POWER wargs}
    {EOM_SIDE POWER windsong}
    {multiplayer/factions/loyalists-aoh.cfg}
    {multiplayer/factions/rebels-aoh.cfg}
    {multiplayer/factions/northerners-aoh.cfg}
    {multiplayer/factions/undead-aoh.cfg}
    {multiplayer/factions/knalgans-aoh.cfg}
    {multiplayer/factions/drakes-aoh.cfg}
    {multiplayer/factions/khalifate-aoh.cfg}

    {QUICK_4MP_LEADERS}
    {TURNS_OVER_ADVANTAGE}
    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

[era]
    id=era_EOM_recruit_{ERA_OF_MYTHS_VERSION}
    name= _ "Myths RPG" #Era of Myths - RPG
    require_era=yes
    description= _ "An Era for RPG Playing. You cannot recruit units."

    {RANDOM_SIDE}
    {EOM_SIDE RECRUIT celestials}
    {EOM_SIDE RECRUIT devlings}
    {EOM_SIDE RECRUIT elementals}
    {EOM_SIDE RECRUIT therians}
    {EOM_SIDE RECRUIT vampires}
    {EOM_SIDE RECRUIT wargs}
    {EOM_SIDE RECRUIT windsong}

    #{UNDRAINABLE_VAMPIRE_LEADERS}
[/era]

#undef EOM_SIDE
